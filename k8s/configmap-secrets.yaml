# Research Collaboration System - ConfigMaps and Secrets
# NOTE: In production, use sealed-secrets or external secrets manager
apiVersion: v1
kind: Namespace
metadata:
  name: research-system
  labels:
    name: research-system
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: research-api-config
  namespace: research-system
data:
  LOG_LEVEL: "INFO"
  ENVIRONMENT: "production"
  API_VERSION: "v1"
  CORS_ORIGINS: "*"
  MAX_CONNECTIONS: "100"
  CACHE_TTL: "300"
---
# ServiceAccount for the API
apiVersion: v1
kind: ServiceAccount
metadata:
  name: research-api-sa
  namespace: research-system
---
# Secret template (values should be base64 encoded or use sealed-secrets)
# In production, use: kubectl create secret generic research-secrets --from-literal=...
apiVersion: v1
kind: Secret
metadata:
  name: research-secrets
  namespace: research-system
type: Opaque
stringData:
  # IMPORTANT: Replace these with actual secrets in production
  # Use external secrets manager (AWS Secrets Manager, HashiCorp Vault, etc.)
  mongodb-uri: "mongodb://admin:CHANGE_ME@mongodb:27017/research_collaboration?authSource=admin"
  neo4j-uri: "bolt://neo4j:7687"
  neo4j-user: "neo4j"
  neo4j-password: "CHANGE_ME"
  redis-url: "redis://:CHANGE_ME@redis:6379"
  jwt-secret: "CHANGE_ME_TO_SECURE_SECRET_KEY"
---
# HorizontalPodAutoscaler for auto-scaling
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: research-api-hpa
  namespace: research-system
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: research-api
  minReplicas: 2
  maxReplicas: 10
  metrics:
  - type: Resource
    resource:
      name: cpu
      target:
        type: Utilization
        averageUtilization: 70
  - type: Resource
    resource:
      name: memory
      target:
        type: Utilization
        averageUtilization: 80
  behavior:
    scaleDown:
      stabilizationWindowSeconds: 300
      policies:
      - type: Percent
        value: 10
        periodSeconds: 60
    scaleUp:
      stabilizationWindowSeconds: 0
      policies:
      - type: Percent
        value: 100
        periodSeconds: 15
